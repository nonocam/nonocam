(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(845)}])},845:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return k}});var i=n(1438),o=n(8029),r=n(603),a=n(6567),s=n(5893),c=n(9008),d=n.n(c),m=n(7294),f=n(214),u=n.n(f),l=n(4298),h=n.n(l),g=n(1021),b=n(357),x=n.n(b),p=function(t){(0,o.Z)(n,t);var e=(0,a.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return n.prototype.render=function(){return(0,s.jsxs)("div",{className:"jsx-3470c45fb8b8e740 turnDevice",children:[(0,s.jsx)("div",{className:"jsx-3470c45fb8b8e740 icon",children:"\uD83D\uDCF1"}),(0,s.jsx)("h1",{className:"jsx-3470c45fb8b8e740 text-white text-2xl",children:"Please use your device in Landscape"}),(0,s.jsx)(x(),{id:"3470c45fb8b8e740",children:".turnDevice.jsx-3470c45fb8b8e740{position:fixed;width:100%;height:100%;background-color:black;padding:2rem;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;text-align:center;z-index:10000000000000}.turnDevice.jsx-3470c45fb8b8e740 h1.jsx-3470c45fb8b8e740{margin-top:1rem}.icon.jsx-3470c45fb8b8e740{font-size:5rem;-webkit-animation-name:spin;-moz-animation-name:spin;-o-animation-name:spin;animation-name:spin;-webkit-animation-duration:2s;-moz-animation-duration:2s;-o-animation-duration:2s;animation-duration:2s;-webkit-animation-iteration-count:infinite;-moz-animation-iteration-count:infinite;-o-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:linear;-moz-animation-timing-function:linear;-o-animation-timing-function:linear;animation-timing-function:linear}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}30%{-webkit-transform:rotate(90deg);transform:rotate(90deg)}100%{-webkit-transform:rotate(90deg);transform:rotate(90deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}30%{-moz-transform:rotate(90deg);transform:rotate(90deg)}100%{-moz-transform:rotate(90deg);transform:rotate(90deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}30%{-o-transform:rotate(90deg);transform:rotate(90deg)}100%{-o-transform:rotate(90deg);transform:rotate(90deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}30%{-webkit-transform:rotate(90deg);-moz-transform:rotate(90deg);-o-transform:rotate(90deg);transform:rotate(90deg)}100%{-webkit-transform:rotate(90deg);-moz-transform:rotate(90deg);-o-transform:rotate(90deg);transform:rotate(90deg)}}"})]})},n}(m.Component),w={video:{facingMode:"environment",frameRate:24,width:640,height:360}};function v(t){var e,n,i,o,r,a=t.videoRef,c=t.trackedObject,d=(n=a.videoHeight,i=a.videoWidth/n,o=a.offsetWidth,o/(r=a.offsetHeight)>i?o=r*i:r=o/i,{width:o,height:r}),m=0;a.clientHeight>d.height&&(m=(a.clientHeight-d.height)/2);var f=0;a.clientWidth>d.width&&(f=(a.clientWidth-d.width)/2);var l={top:m+c.y*d.height,height:c.h*d.height,left:f+c.x*d.width,width:c.w*d.width};return(0,s.jsxs)("div",{className:u().boundingBox,style:l,children:[c.name," #",c.id," ",Math.round(100*c.confidence),"%"]})}var k=function(t){(0,o.Z)(n,t);var e=(0,a.Z)(n);function n(t){var o;return(0,i.Z)(this,n),(o=e.call(this,t)).model=void 0,o.videoRef=(0,m.createRef)(),o.state={isLoading:!0,fps:0,boundingBoxes:[],counterPerson:0,counterBicycle:0,counterCar:0,counterTruck:0,lastIdPerson:-1,lastIdBicycle:-1,lastIdCar:-1,lastIdTruck:-1},o}var c=n.prototype;return c.predictionToOpenDataCamDetection=function(t,e,n){return{x:t.bbox[0]/e,y:t.bbox[1]/n,w:t.bbox[2]/e,h:t.bbox[3]/n,confidence:t.score,name:t.class}},c.componentDidMount=function(){var t=this,e=this,n=0,i=0;navigator.mediaDevices.getUserMedia(w).then(function(t){var o=(0,r.Z)(function(t){if(0==t.getVideoTracks().length)return[0,0];var e=t.getVideoTracks()[0].getSettings().width,n=t.getVideoTracks()[0].getSettings().height;return void 0!==e&&void 0!==n?[e,n]:[0,0]}(t),2),a=o[0],c=o[1];cocoSsd.load().then(function(o){if(null===e.videoRef.current)throw"videoRef should never be null!";e.model=o,e.setState({isLoading:!1}),e.videoRef.current.srcObject=t,e.videoRef.current.addEventListener("loadeddata",function(){!function t(){e.model.detect(e.videoRef.current).then(function(o){n+=1,i+=1;var r=o.map(function(t){return e.predictionToOpenDataCamDetection(t,a,c)});(0,g.eL)(r,i);var d=(0,g.co)(!1);e.setState({boundingBoxes:d.map(function(t){if(null===e.videoRef.current)throw"videoRef should never be null!";return(0,s.jsx)(v,{trackedObject:t,videoRef:e.videoRef.current},t.id)})}),d.sort(function(t,e){return t.id-e.id}).forEach(function(t){"person"===t.name&&t.id>e.state.lastIdPerson?e.setState({lastIdPerson:t.id,counterPerson:e.state.counterPerson+1}):"bicycle"===t.name&&t.id>e.state.lastIdBicycle?e.setState({lastIdBicycle:t.id,counterBicycle:e.state.counterBicycle+1}):"car"===t.name&&t.id>e.state.lastIdCar?e.setState({lastIdCar:t.id,counterCar:e.state.counterCar+1}):"truck"===t.name&&t.id>e.state.lastIdTruck&&e.setState({lastIdTruck:t.id,counterTruck:e.state.counterTruck+1})}),window.requestAnimationFrame(t)})}()})})},function(t){console.log(t)}),setInterval(function(){t.setState({fps:n}),n=0},1e3),this.setState({isPortrait:window.innerHeight>window.innerWidth}),window.addEventListener("resize",function(){t.setState({isPortrait:window.innerHeight>window.innerWidth})})},c.render=function(){return(0,s.jsxs)("div",{className:u().container,children:[(0,s.jsx)(d(),{children:(0,s.jsx)("title",{children:"nonocam"})}),(0,s.jsxs)("main",{className:u().main,children:[this.state.isLoading&&(0,s.jsx)("p",{style:{position:"fixed",top:"50%",left:"0",width:"100%",textAlign:"center"},children:"nonocam loadingâ€¦"}),!this.state.isLoading&&this.state.isPortrait&&(0,s.jsx)(p,{}),(0,s.jsx)("video",{className:u().webcam,autoPlay:!0,playsInline:!0,ref:this.videoRef}),this.state.boundingBoxes,!this.state.isLoading&&(0,s.jsxs)("p",{className:u().footer,children:[(0,s.jsxs)("span",{children:["\uD83D\uDEB6 ",this.state.counterPerson]}),(0,s.jsxs)("span",{children:["\uD83D\uDEB4 ",this.state.counterBicycle]}),(0,s.jsxs)("span",{children:["\uD83D\uDE97 ",this.state.counterCar]}),(0,s.jsxs)("span",{children:["\uD83D\uDE9A ",this.state.counterTruck]}),(0,s.jsxs)("span",{children:[this.state.fps," fps"]})]})]}),(0,s.jsx)(h(),{id:"tfjs-3.11",src:"https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.11.0/dist/tf.min.js",strategy:"beforeInteractive"}),(0,s.jsx)(h(),{id:"cocoSsd",src:"https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd",strategy:"beforeInteractive"})]})},n}(m.Component)},214:function(t){t.exports={container:"Home_container__bCOhY",main:"Home_main__nLjiQ",footer:"Home_footer____T7K",card:"Home_card___LpL1",code:"Home_code__suPER",logo:"Home_logo__27_tb",webcam:"Home_webcam__xt_Kp",boundingBox:"Home_boundingBox__4UTwN"}}},function(t){t.O(0,[967,774,888,179],function(){return t(t.s=8312)}),_N_E=t.O()}]);